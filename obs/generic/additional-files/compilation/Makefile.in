
# This macros are replaced by build-scripts/template_stage.sh
# according to the values and regular expressions defined in
# build-scripts/configuration_information.sh
TARGET_DIR = %TARGET_DIR%
TARBALL_DIR = $(shell pwd)
BUILD_DIR = $(TARBALL_DIR)/build
INSTALL_DIR = $(DESTDIR)$(TARGET_DIR)
RUN_BUILDOUT_DIR = $(BUILD_DIR)$(TARGET_DIR)


all: build

build: build-stamp
build-stamp:
	cd "$(RUN_BUILDOUT_DIR)" && ./bin/buildout -v

	@touch build-stamp

clean:
	rm -rf "$(BUILD_DIR)"
	rm -f *-stamp

install: all
	mkdir -p "$(INSTALL_DIR)/bin"
	mkdir -p "$(INSTALL_DIR)/share"
	cp -r "$(RUN_BUILDOUT_DIR)/parts/lunzip/bin/"* "$(INSTALL_DIR)/bin"
	cp -r "$(RUN_BUILDOUT_DIR)/parts/lunzip/share/"* "$(INSTALL_DIR)/share"

.PHONY: build all clean install
